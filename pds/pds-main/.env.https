# ====================================================================
# PDS Configuration with HTTPS (Caddy) - LOCAL TESTING
# ====================================================================
# This configuration uses Caddy as a reverse proxy to provide HTTPS
# for local testing. Caddy will generate self-signed certificates.
#
# Usage:
#   1. Install Caddy: https://caddyserver.com/docs/install
#   2. Start PDS: node service/index.js
#   3. Start Caddy: caddy run --config Caddyfile
#   4. Access PDS at: https://pds.localhost
# ====================================================================

# ====================================================================
# Basic Server Configuration
# ====================================================================
# The PDS listens on HTTP (Caddy will handle HTTPS)
PDS_HOSTNAME=pds.localhost
PDS_PORT=3002

# ====================================================================
# Security Secrets
# ====================================================================
# IMPORTANT: Generate strong secrets for production!
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
PDS_JWT_SECRET=local-dev-jwt-secret-change-me-in-production
PDS_ADMIN_PASSWORD=admin123
PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX=

# ====================================================================
# Data Storage (Local Paths)
# ====================================================================
PDS_DATA_DIRECTORY=./data
PDS_BLOBSTORE_DISK_LOCATION=./data/blocks
PDS_BLOB_UPLOAD_LIMIT=104857600

# ====================================================================
# DID Configuration
# ====================================================================
# Use did:web for local testing (works with HTTPS via Caddy)
PDS_SERVICE_DID=did:web:pds.localhost

# Or use did:plc if you want to test with the PLC directory
# PDS_DID_PLC_URL=https://plc.directory

# ====================================================================
# Optional: Connect to Bluesky Federation (for testing federation)
# ====================================================================
# Uncomment these if you want to test federation features
# Note: Requires HTTPS to work properly (provided by Caddy)
#PDS_DID_PLC_URL=https://plc.directory
#PDS_BSKY_APP_VIEW_URL=https://api.bsky.app
#PDS_BSKY_APP_VIEW_DID=did:web:api.bsky.app
#PDS_REPORT_SERVICE_URL=https://mod.bsky.app
#PDS_REPORT_SERVICE_DID=did:plc:ar7c4by46qjdydhdevvrndac
#PDS_CRAWLERS=https://bsky.network

# ====================================================================
# Service Handles
# ====================================================================
# Allow handles under your domain
PDS_SERVICE_HANDLE_DOMAINS=.pds.localhost

# ====================================================================
# Repository & Imports
# ====================================================================
PDS_ACCEPTING_REPO_IMPORTS=true
PDS_MAX_REPO_IMPORT_SIZE=104857600

# ====================================================================
# Logging
# ====================================================================
LOG_ENABLED=true
LOG_LEVEL=info
# Optional: Log to file
# LOG_DESTINATION=./data/pds.log

# ====================================================================
# Email Configuration (Optional for local testing)
# ====================================================================
# Uncomment and configure if you need email functionality
#PDS_EMAIL_SMTP_URL=smtp://username:password@smtp.example.com:587
#PDS_EMAIL_FROM_ADDRESS=noreply@pds.localhost

# ====================================================================
# Rate Limiting (Optional)
# ====================================================================
# Uncomment to enable rate limiting
#PDS_RATE_LIMITS_ENABLED=true
#PDS_RATE_LIMIT_BYPASS_KEY=your-bypass-key-for-testing
#PDS_RATE_LIMIT_BYPASS_IPS=127.0.0.1

# ====================================================================
# Database Configuration (Advanced)
# ====================================================================
# SQLite database locations (defaults are usually fine)
#PDS_ACCOUNT_DB_LOCATION=./data/account.sqlite
#PDS_SEQUENCER_DB_LOCATION=./data/sequencer.sqlite
#PDS_DID_CACHE_DB_LOCATION=./data/did-cache.sqlite

# Disable WAL auto-checkpoint for better performance (optional)
#PDS_SQLITE_DISABLE_WAL_AUTO_CHECKPOINT=true

# ====================================================================
# Contact & Branding (Optional)
# ====================================================================
#PDS_SERVICE_NAME=My Local PDS
#PDS_CONTACT_EMAIL_ADDRESS=admin@pds.localhost
#PDS_HOME_URL=https://pds.localhost
#PDS_LOGO_URL=https://pds.localhost/logo.png
#PDS_PRIVACY_POLICY_URL=https://pds.localhost/privacy
#PDS_TERMS_OF_SERVICE_URL=https://pds.localhost/terms
#PDS_SUPPORT_URL=https://pds.localhost/support
